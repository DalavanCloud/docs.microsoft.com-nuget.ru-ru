---
title: "Каталог, NuGet V3 API | Документы Microsoft"
author:
- joelverhagen
- kraigb
ms.author:
- joelverhagen
- kraigb
manager: skofman
ms.date: 10/30/2017
ms.topic: reference
ms.prod: nuget
ms.technology: 
ms.assetid: cfd338b5-6253-48c0-88ba-17c6b98fc935
description: "Каталог — это индекс всех пакетов создаются и удаляются в nuget.org."
keywords: "NuGet V3 API каталога, nuget.org журнала транзакций, репликации NuGet.org, можно клонировать NuGet.org, дополняющие запись NuGet.org"
ms.reviewer:
- karann
- unniravindranathan
ms.openlocfilehash: 4c98b7cbd92575f6905e98a5bca5602a4d8ac0dd
ms.sourcegitcommit: a40c1c1cc05a46410f317a72f695ad1d80f39fa2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/05/2018
---
# <a name="catalog"></a>Catalog

**Каталога** — это ресурс, в котором фиксируются все операции пакета источника пакета, например операции создания и удаления. У ресурса каталога `Catalog` введите [служба индекс](service-index.md).

> [!Note]
> Так как каталог не используется официальный NuGet клиента, не все источники пакетов реализации каталога.

> [!Note]
> В настоящее время nuget.org каталог недоступен в Китае. Дополнительные сведения см. в разделе [&#4949; NuGet/NuGetGallery](https://github.com/NuGet/NuGetGallery/issues/4949).

## <a name="versioning"></a>Управление версиями

Следующие `@type` используется значение:

Значение @type   | Примечания
------------- | -----
CATALOG/3.0.0 | Первоначальный выпуск

## <a name="base-url"></a>Базовый URL-адрес

URL-адрес точки входа для следующих API-интерфейсов — это значение `@id` свойства, связанные с ресурсом упомянутой выше `@type` значения. В этом разделе используется заполнитель URL-адрес `{@id}`.

## <a name="http-methods"></a>Методы HTTP

Все URL-адреса, найденные в поддержку ресурсов каталога только методы HTTP `GET` и `HEAD`.

## <a name="catalog-index"></a>Индекс в каталоге

Индекс в каталоге является документом в хорошо известных расположении, которое содержит список элементов каталога, упорядоченных cronologically. Это точка входа ресурса каталога.

Индекс состоит из страниц каталога. Каждая страница каталога содержит элементы каталога. Каждый элемент каталога представляет событие, касающиеся один пакет на момент времени. Элемент каталога может представлять пакета, который был создан, отсутствующие в списке, relisted или удален из источника пакета. При обработке элементы каталога в хронологическом порядке, клиент можно построить актуальное представление каждого пакета, который существует в источнике пакета V3.

Иными словами каталог больших двоичных объектов имеют следующие иерархическую структуру:

- **Индекс**: точку входа для каталога.
- **Страница**: группирование элементов каталога.
- **Конечный**: документ, представляющий элемент каталога, который представляет собой моментальный снимок состояния одного пакета.

Каждый объект каталога имеет свойство с именем `commitTimeStamp` представления при добавлении элемента в каталоге. Страница каталога в пакетах, вызывается фиксации добавляются элементы каталога. Все элементы каталога в одной фиксации имеют одну и ту же метку времени фиксации (`commitTimeStamp`) и зафиксировать код (`commitId`). Элементы каталога, размещенные в одном фиксации представления событий, возникших примерно в тот же момент времени в источнике пакета. Нет, не порядок в фиксации каталога.

Поскольку каждый ИД пакета и версия, никогда не будет более одного элемента каталога в фиксации. Это гарантирует, что элементов каталога на один пакет может всегда однозначно упорядочиваться по отношению к меткой времени фиксации.

Нет никогда не будет более чем одна фиксация в каталог за `commitTimeStamp`. Другими словами `commitId` является избыточным с `commitTimeStamp`.

В отличие от к [пакета ресурс метаданных](registration-base-url-resource.md), которая индексируется по Идентификатору пакета, каталоге индексированных (и доступна для запросов) только по времени.

Элементы каталога всегда добавляются в каталог в монотонно возрастающей хронологическом порядке. Это означает, что, если фиксации каталог будет добавлен во время X затем без фиксации каталога никогда не добавляется с временем меньше или равно X.

Следующий запрос извлекает указатель каталога.

```
GET {@id}
```

Индекс каталога является документ JSON, который содержит объект со следующими свойствами:

name            | Тип             | Обязательно | Примечания
--------------- | ---------------- | -------- | -----
commitId        | string           | да      | Уникальный идентификатор, связанный с самой последней фиксации
commitTimeStamp | string           | да      | Отметка времени последней фиксации
count           | целочисленный          | да      | Количество страниц в индексе
items           | Массив объектов | да      | Массив объектов, каждый объект, представляющий страницы

Каждый элемент в `items` массив является объектом с некоторыми минимальных сведений о каждой странице. Эти объекты не могут содержать оставляет каталога (элементы). Порядок элементов в массиве не определен. Страницы могут быть упорядочены клиентом в памяти с помощью их `commitTimeStamp` свойство.

Добавляются новые страницы, `count` увеличивается, и новые объекты будут отображаться в `items` массива.

При добавлении элементов каталога, индекс `commitId` изменится и `commitTimeStamp` увеличится. Эти два свойства: фактически Сводка поверх всех страницы `commitId` и `commitTimeStamp` значения в `items` массива.

### <a name="catalog-page-object-in-the-index"></a>Объект каталога страницы в индексе

Объекты каталога страницы, включенные в индекс каталога `items` свойства имеют следующие свойства:

name            | Тип    | Обязательно | Примечания
--------------- | ------- | -------- | -----
@id             | string  | да      | URL-адрес страницы каталога выборки
commitId        | string  | да      | Уникальный идентификатор, связанный с самой последней фиксацией на этой странице
commitTimeStamp | string  | да      | Отметка времени последней фиксации на этой странице
count           | целочисленный | да      | Число элементов на странице каталога

В отличие от [пакета ресурс метаданных](registration-base-url-resource.md) каких в некоторых случаях внутристрочные элементы остаются в индекс, оставляет каталога никогда не являются встроенными в индекс и всегда должны быть извлечены с помощью страницы `@id` URL-адрес.

### <a name="sample-request"></a>Пример запроса

```
GET https://api.nuget.org/v3/catalog0/index.json
```

### <a name="sample-response"></a>Пример ответа

[!code-JSON [catalog-index.json](./_data/catalog-index.json)]

## <a name="catalog-page"></a>Страница каталога

Страница каталога — это совокупность элементов каталога. Это документ, выбранных с помощью одного из `@id` обнаружены значения в индексе каталога. URL-адрес страницы каталога не является прогнозируемым и должен быть обнаружен только по индексу каталога.

Новые элементы каталога, добавляются к странице в индексе каталога только с наивысшим меткой времени фиксации, либо на новую страницу. После добавления страницы с более высоким меткой времени фиксации в каталог более старые страницы никогда не добавлены или изменены.

Документ каталога страницы — это объект JSON со следующими свойствами:

name            | Тип             | Обязательно | Примечания
--------------- | ---------------- | -------- | -----
commitId        | string           | да      | Уникальный идентификатор, связанный с самой последней фиксацией на этой странице
commitTimeStamp | string           | да      | Отметка времени последней фиксации на этой странице
count           | целочисленный          | да      | Число элементов на странице
items           | Массив объектов | да      | Элементы каталога на этой странице
parent          | string           | да      | URL-адрес каталога

Каждый элемент в `items` массив является объектом с некоторыми минимальных сведений о элемента каталога. Эти объекты элемента не содержат все данные элемента каталога. Порядок элементов на странице `items` массива не определен. Элементы могут упорядочиваться клиентом в памяти с помощью их `commitTimeStamp` свойство.

Количество элементов каталога на странице определяется реализация сервера. Для nuget.org не превышает 550 элементы на каждой странице, несмотря на то, что фактическое число может быть меньше для некоторых страниц dependong на размер следующего пакета в точке фиксации времени.

Добавляются новые элементы, `count` объекты увеличивается и новый каталог элемента, отображаются в `items` массива.

При добавлении элементов на страницу `commitId` изменений и `commitTimeStamp` увеличивается. Эти два свойства: фактически сводку по всем `commitId` и `commitTimeStamp` значения в `items` массива.

### <a name="catalog-item-object-in-a-page"></a>Объект элемента на странице каталога

Элемент каталога объекты, включенные в страницу каталога `items` свойства имеют следующие свойства:

name            | Тип    | Обязательно | Примечания
--------------- | ------- | -------- | -----
@id             | string  | да      | URL-адрес для получения элемента каталога
@type           | string  | да      | Тип элемента каталога
commitId        | string  | да      | Идентификатор фиксации, связанный с этим элементом каталога
commitTimeStamp | string  | да      | Метка времени фиксации данного элемента каталога
NuGet:ID        | string  | да      | Идентификатор пакета, связанного с этой конечного
NuGet:Version   | string  | да      | Версия пакета, связанного с этой конечного

`@type` Значение будет одним из следующих двух значений:

1. `nuget:PackageDetails`: это соответствует `PackageDetails` типа в документе конечного каталога.
1. `nuget:PackageDelete`: это соответствует `PackageDelete` типа в документе конечного каталога.

Дополнительные сведения о означает каждый тип, в разделе [соответствующие элементы типа](#item-types) ниже.

### <a name="sample-request"></a>Пример запроса

```
GET https://api.nuget.org/v3/catalog0/page2926.json
```

### <a name="sample-response"></a>Пример ответа

[!code-JSON [catalog-page.json](./_data/catalog-page.json)]

## <a name="catalog-leaf"></a>Конечный каталог

Конечный каталог содержит метаданные о конкретных ИД и версию пакета в определенный момент времени. Это документ, выбранных с помощью `@id` , найденного на странице каталога. URL-адрес конечного каталога не является predictedable и должен быть обнаружен в каталоге страницы.

Документ конечного каталога — это объект JSON со следующими свойствами:

name                    | Тип                       | Обязательно | Примечания
----------------------- | -------------------------- | -------- | -----
@type                   | Строка или массив строк | да      | Типы элемента каталога
каталог: commitId        | string                     | да      | Идентификатор фиксации, связанный с этим элементом каталога
каталог: commitTimeStamp | string                     | да      | Метка времени фиксации данного элемента каталога
id                      | string                     | да      | Идентификатор пакета элемента каталога
Опубликован               | string                     | да      | Дата публикации элемента каталога пакета
version                 | string                     | да      | Версия пакета элемента каталога

### <a name="item-types"></a>Типы элементов

`@type` Свойство — это строка или массив строк. Для удобства Если `@type` значение является строкой, следует считать какой-либо массив одного размера. Не все возможные значения для `@type` задокументированы. Однако каждый элемент каталога имеет только один из двух значений типа следующие строки:

1. `PackageDetails`: представляет собой моментальный снимок метаданные пакета
1. `PackageDelete`: представляет пакет, который был удален

### <a name="package-details-catalog-items"></a>Сведения о пакете элементы каталога

Элементы с типом каталога `PackageDetails` содержится моментальный снимок метаданные для конкретного пакета (ИД и версию сочетание). Элемент каталога сведения о пакете возникает в том случае, если источник пакета обнаружит любой из следующих сценариев:

1. Пакет — **помещено**.
1. Пакет — **перечисленных**.
1. Пакет — **отсутствующие в списке**.
1. Пакет — **перекомпоновки**.

Перекомпоновка пакета жест администратора, по существу создающий фиктивный принудительной существующего пакета без изменения самого пакета. На nuget.org после исправления ошибки в одном из фоновых заданий, которые занимают каталога используется нефиксированного формата.

Использование элементов каталога клиентов не следует пытаться определить, какие из этих сценариев созданного элемента каталога. Вместо этого клиент должен просто обновить любые сохранения представления или индекса с метаданные, содержащиеся в элемент каталога. Кроме того, элементы повторяющийся или избыточный каталога должен быть корректно обработаны (идемпотентной).

Элементы каталога сведения о пакете имеют следующие свойства помимо тех, [на все конечные каталога](#catalog-leaf).

name                    | Тип                       | Обязательно | Примечания
----------------------- | -------------------------- | -------- | -----
authors                 | string                     | Нет       |
created                 | string                     | да      | Отметку времени, при первом создании пакета
dependencyGroups        | Массив объектов           | Нет       | Том же формате, как [пакета ресурс метаданных](registration-base-url-resource.md#package-dependency-group)
Описание             | string                     | Нет       |
iconUrl                 | string                     | Нет       |
isPrerelease            | boolean                    | да      | Ли предварительная версия пакета
язык                | string                     | Нет       |
licenseUrl              | string                     | Нет       |
перечисленные                  | boolean                    | Нет       | Указан ли пакет
MinClientVersion        | string                     | Нет       |
packageHash             | string                     | да      | Хэш-код пакета, кодирование с помощью [стандартные base-64](https://tools.ietf.org/html/rfc4648#section-4)
packageHashAlgorithm    | string                     | да      |
packageSize             | целочисленный                    | да      | Размер .nupkg пакета в байтах
projectUrl              | string                     | Нет       |
releaseNotes            | string                     | Нет       |
requireLicenseAgreement | boolean                    | Нет       | Предположим, `false` в исключении
сводка                 | string                     | Нет       |
теги                    | Массив строк           | Нет       |
заголовок                   | string                     | Нет       |
verbatimVersion         | string                     | Нет       | Строка версии, как он изначально находится в .nuspec

Пакет `version` свойство представляет собой нормализованное полной версией строку. Это означает, что данные сборки SemVer 2.0.0 может быть включено здесь.

`created` Отметка времени — Если пакет был сначала получает источника пакета, как правило, некоторое время перед меткой времени фиксации элемент каталога.

`packageHashAlgorithm` Является строка определяется represeting реализация сервера алгоритм хэширования, используемый для создания `packageHash`. всегда используется NuGet.org `packageHashAlgorithm` значение `SHA512`.

`published` Отметка времени — времени, когда последнего перечисленные пакета.

> [!Note]
> На nuget.org `published` имеет значение года 1900, если пакет не включенных в список.

#### <a name="sample-request"></a>Пример запроса

```
GET https://api.nuget.org/v3/catalog0/data/2015.02.01.11.18.40/windowsazure.storage.1.0.0.json
```

#### <a name="sample-response"></a>Пример ответа

[!code-JSON [catalog-package-details.json](./_data/catalog-package-details.json)]

### <a name="package-delete-catalog-items"></a>Элементы каталога удаления пакета

Элементы с типом каталога `PackageDelete` содержит минимальный набор сведений, для клиентов каталога, что пакет был удален из исходного пакета и больше не доступен для любой операции пакета (например, восстановление).

> [!Note]
> Это возможно, для пакета для удаления и более поздней версии повторно с помощью того же ИД и версию пакета. На nuget.org Это редкая так как влекут за собой разрыв официальный клиента предположение, что ИД пакета и версия определяют содержимое указанного пакета. Дополнительные сведения об удалении пакета nuget.org. в разделе [нашей политике](../policies/deleting-packages.md).

Пакет удаления каталога элементы имеют дополнительные свойства помимо тех, [на все конечные каталога](#catalog-leaf).

`version` Свойство является исходной строки версии в пакете .nuspec.

`published` Свойство является время удаления пакета, как правило, как короткое время перед меткой времени фиксации элемента каталога.

#### <a name="sample-request"></a>Пример запроса

```
GET https://api.nuget.org/v3/catalog0/data/2017.11.02.00.40.00/netstandard1.4_lib.1.0.0-test.json
```

#### <a name="sample-response"></a>Пример ответа

[!code-JSON [catalog-package-delete.json](./_data/catalog-package-delete.json)]

## <a name="cursor"></a>Курсор

### <a name="overview"></a>Обзор

В этом разделе описываются понятием клиента, несмотря на то, что не является обязательной обязательно протоколом, должны быть частью любой реализации практических каталога клиента.

Так как каталог является структурой данных только для добавления, индексированный по времени, клиент должен сохранять **курсор** локально, представляющий не более чем на определенный момент времени клиент обработал элементы каталога. Обратите внимание, что значение для курсора должны никогда не создаваться часов компьютера клиента с помощью. Вместо этого значение должны поступать из объекта каталога `commitTimestamp` значение.

Каждый раз, клиенту необходимо обрабатывать новые события в источнике пакета, она должна только запрос каталога для всех элементов каталога с меткой времени фиксации больше, чем хранимые курсор. После успешного клиент обрабатывает все новые элементы каталога, она записывает последняя метка времени фиксации позиций каталога, просто обрабатывается как его новое значение курсора.

При таком подходе клиента можно убедиться, что никогда не пропустите любого пакета событий, произошедших в источнике пакета.
Кроме того клиент не может выполнить повторную обработку старые события перед меткой времени записанные фиксации курсора.

Такая концепция курсоров используется для многих nuget.org фоновых заданий и используется для поддержания актуального состояния сам интерфейс API V3. 

### <a name="initial-value"></a>Исходное значение

Когда клиент каталога запускается в первый раз (и поэтому не курсора значение), следует использовать значение по умолчанию курсора. NET `System.DateTimeOffset.MinValue` или определенные таких аналогами понятия Минимальная метка времени может быть представлен.

### <a name="iterating-over-catalog-items"></a>Перебор объектов из каталога

Для выполнения запроса для следующего набора элементов каталога для обработки, клиент должен выполнить следующее.

1. Получить значение записанные курсора из локального хранилища.
1. Загрузить и выполнить десериализацию индекс в каталоге.
1. Найти все каталога страницы с меткой времени фиксации *больше* курсора.
1. Объявите пустой список элементов каталога для обработки.
1. Для каждой страницы каталога соответствует на шаге 3:
   1. Загрузите и десериализовать страницу каталога.
   1. Найти все элементы с меткой времени фиксации каталога *больше* курсора.
   1. Добавьте все подходящие элементы каталога в список, объявленной в шаге 4.
1. Сортировка списка элементов каталога с меткой времени фиксации.
1. Обработка каждого элемента каталога в последовательности.
   1. Загрузить и выполнить десериализацию элемента каталога.
   1. Выполнить соответствующие действия для типа элемента каталога.
   1. Процесс документа элемент каталога в виде конкретного клиента.
1. Записи меткой времени фиксации последнего элемента каталога в новое значение курсора.

С этой основной алгоритм реализация клиента можете надстраивать полное представление всех пакетов, доступных в источнике пакета. Клиент должны выполняться только этот алгоритм периодически необходимо всегда принимать во внимание последние изменения в исходную папку пакета.

> [!Note]
> Это алгоритм, nuget.org использует, чтобы [метаданные пакета](registration-base-url-resource.md), [содержимое пакета](package-base-address-resource.md), [поиска](search-query-service-resource.md) и [автозаполнения](search-autocomplete-service-resource.md) ресурсы в актуальном состоянии.

### <a name="dependent-cursors"></a>Зависимые курсоров

Предположим, что существует два клиента каталога, имеющие зависимость inherant, где выходные данные одного клиента зависит от выходных данных другого клиента. 

#### <a name="example"></a>Пример

Например на nuget.org только что опубликованный пакет не должен появляться в поиск ресурсов до появления в ресурсе метаданные пакета. Это так, как «restore» операция, выполняемая официальный NuGet клиент использует ресурс метаданные пакета. Если клиент обнаруживает пакета с помощью службы поиска, получить для успешного восстановления этого пакета с помощью ресурса метаданные пакета. Другими словами поиск ресурсов зависит от ресурса метаданные пакета. Каждый ресурс имеет фоновое задание каталога клиента обновление этого ресурса. Каждый клиент имеет свой собственный курсор.

Поскольку оба ресурса построены из каталога, курсор клиента каталога, который обновляет ресурс поиска *не должно превышать* курсора клиента каталога метаданных пакета.

#### <a name="algorithm"></a>Алгоритм

Для реализации этого ограничения, простое изменение алгоритма выше, чтобы быть:

1. Получить значение записанные курсора из локального хранилища.
1. Загрузить и выполнить десериализацию индекс в каталоге.
1. Найти все каталога страницы с меткой времени фиксации *больше* курсор **меньше или равно зависимостей курсора.**
1. Объявите пустой список элементов каталога для обработки.
1. Для каждой страницы каталога соответствует на шаге 3:
   1. Загрузите и десериализовать страницу каталога.
   1. Найти все элементы с меткой времени фиксации каталога *больше* курсор **меньше или равно зависимостей курсора.**
   1. Добавьте все подходящие элементы каталога в список, объявленной в шаге 4.
1. Сортировка списка элементов каталога с меткой времени фиксации.
1. Обработка каждого элемента каталога в последовательности.
   1. Загрузить и выполнить десериализацию элемента каталога.
   1. Выполнить соответствующие действия для типа элемента каталога.
   1. Процесс документа элемент каталога в виде конкретного клиента.
1. Записи меткой времени фиксации последнего элемента каталога в новое значение курсора.

С помощью этого изменения алгоритма, можно создавать системы каталога зависимых клиентов все создавать свои собственные конкретных индексов, артефакты и т. д.

---
title: "Что такое NuGet и для чего он нужен | Документы Майкрософт"
author: kraigb
ms.author: kraigb
manager: ghogen
ms.date: 10/26/2017
ms.topic: hero-article
ms.prod: nuget
ms.technology: 
ms.assetid: c3faf278-4cbf-4733-96f6-9ee9f7203af9
description: "Комплексное введение о том, что такое NuGet и для чего он нужен"
keywords: "диспетчер пакетов NuGet, использование, создание пакетов, размещение пакетов"
ms.reviewer:
- karann-msft
- unniravindranathan
ms.openlocfilehash: 29dcedf33a54e249fe0b6acf588e4aafde28304f
ms.sourcegitcommit: d0ba99bfe019b779b75731bafdca8a37e35ef0d9
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/14/2017
---
# <a name="an-introduction-to-nuget"></a>Введение в NuGet

Важный инструмент для любой платформы современной разработки — это механизм, с помощью которого разработчики могут создавать, предоставлять для общего доступа и использовать полезные библиотеки кода. Обычно такие библиотеки называются "пакетами", так как они могут содержать скомпилированный код (в виде библиотек DLL) вместе с другим содержимым, которое может понадобиться в проектах, использующих эти библиотеки.

Для .NET механизмом совместного использования кода является **NuGet**, который определяет, как создаются, размещаются и используются пакеты для .NET, а также предоставляет средства для каждой из этих ролей. 

Проще говоря, пакет NuGet представляет собой отдельный ZIP-файл с расширением `.nupkg`, который содержит скомпилированный код (DLL), другие файлы, связанные с этим кодом, и описательный манифест, включающий такие сведения, как номер версии пакета. Разработчики библиотек создают файлы пакетов и публикуют их на узле. Потребители получают эти пакеты, добавляют их в свои проекты и затем вызывают функции этой библиотеки в коде проекта. При этом NuGet сам обрабатывает все промежуточные данные.

## <a name="the-flow-of-packages-between-creators-hosts-and-consumers"></a>Поток пакетов между создателями, узлами и потребителями

Выполняя роль узла, NuGet обслуживает центральный репозиторий с более чем 60 000 уникальных общедоступных пакетов на сайте [nuget.org](https://www.nuget.org). Ежедневно эти пакеты используют миллионы разработчиков .NET. NuGet также позволяет размещать пакеты в частном порядке в облаке, в частной сети или даже в вашей локальной файловой системе. Таким образом, эти пакеты доступны только разработчикам в определенной организации или группе клиентов. Эти возможности описаны в разделе [Размещение своих веб-каналов NuGet](Hosting-Packages/Overview.md).

Независимо от своей природы узел выступает в качестве точки подключения между *создателями* и *потребителями* пакета. Создатели разрабатывают полезные пакеты NuGet и публикуют их на узле. Потребители ищут полезные и совместимые пакеты на доступных узлах, скачивая эти пакеты и включая их в свои проекты. После установки в проекте API пакеты становятся доступны остальной части кода проекта.

![Связь между создателями, узлами и потребителями пакета](media/nuget-roles.png)

"Совместимый" пакет в данном случае означает, что он содержит сборки, созданные по меньшей мере для одной целевой платформы .NET, совместимой с целевой платформой использующего проекта. Чтобы обеспечить обширную совместимость пакета, его создатель компилирует отдельные сборки для различных целевых платформ и включает их все в тот же пакет. Когда потребитель устанавливает этот пакет, NuGet извлекает только сборки, нужные в проекте. Это сводит к минимуму занимаемое пакетом место в конечном приложении или сборках, создаваемых данным проектом.

## <a name="nuget-tools"></a>Средства NuGet

Кроме поддержки размещения, NuGet также предоставляет широкий набор средств, используемых как создателями, так и потребителями:

| Средство | Платформы | Применимые сценарии | Описание |
| --- | --- | --- | --- |
| [Интерфейс командной строки nuget.exe](Tools/nuget-exe-CLI-Reference.md) | Все | Создание, потребление | Предоставляет все функциональные возможности NuGet, при этом часть команд относится к создателям пакета, часть — только к потребителям, а остальные — ко всем. Например, создатели пакета используют команду `nuget pack` для создания пакета из различных сборок и связанных файлов, потребители пакета используют `nuget install` для включения пакетов в проект, при этом все используют `nuget config` для задания переменных конфигурации NuGet.  |
| [Пользовательский интерфейс диспетчера пакетов](Tools/Package-Manager-UI.md) | Visual Studio в Windows | Потребление | Предоставляет удобный пользовательский интерфейс для установки пакетов и управления ими в проектах .NET. | 
| [Управление пользовательским интерфейсом NuGet](https://docs.microsoft.com/visualstudio/mac/nuget-walkthrough) | Visual Studio для Mac | Потребление | Предоставляет удобный пользовательский интерфейс для установки пакетов и управления ими в проектах .NET. |
| [Консоль диспетчера пакетов](Tools/Package-Manager-Console.md) | Visual Studio в Windows | Потребление | Предоставляет [команды PowerShell](Tools/Powershell-Reference.md) для установки пакетов и управления ими в проектах .NET. | 
| [dotnet CLI](Tools/dotnet-Commands.md) | Все | Создание, потребление | Предоставляет определенные возможности CLI NuGet непосредственно внутри цепочки инструментов .NET Core. |
| [MSBuild](Schema/msbuild-targets.md) | Windows | Создание, потребление | Предоставляет возможность создавать и восстанавливать используемые в проекте пакеты напрямую с помощью цепочки инструментов MSBuild. |

Как видите, средства, которые вы используете для работы с NuGet, в значительной степени зависят от того, создаете ли вы (и публикуете) пакеты или используете их, а также от используемой платформы. Более подробные сведения см. в разделах [Рабочий процесс создания пакета](Create-Packages/Overview-and-Workflow.md) и [Рабочий процесс использования пакета](Consume-Packages/Overview-and-Workflow.md), а также других указанных там статьях. 

Создатели пакета обычно также являются потребителями, так как берут за основу функции, имеющиеся в других пакетах NuGet. Конечно же, те пакеты, в свою очередь, могут зависеть еще от каких-либо.

## <a name="managing-dependencies"></a>Управление зависимостями

Возможность легко брать за основу работу других — это один из аспектов, делающих систему управления пакетами настолько эффективной. Соответственно, значительная часть работы NuGet заключается в управлении этим деревом или "графом" зависимостей от имени вашего проекта. Проще говоря, вам нужно заботиться только о тех пакетах, которые вы используете непосредственно в проекте. Если любые эти пакеты используют другие пакеты (которые могут использовать пакеты), все эти зависимости нижнего уровня обрабатывает NuGet.

На следующем рисунке показан проект, зависящий от пяти пакетов, которые, в свою очередь, зависят от нескольких других.  

![Пример графа зависимостей NuGet для проекта .NET](media/dependency-graph.png)

Обратите внимание, что некоторые пакеты встречаются на графе зависимостей несколько раз. Например, существует три разных потребителя пакета B, и каждый из них может также указывать другую версию этого пакета (не показано). Так как это обычная практика, NuGet выполняет всю работу, чтобы определить, какая именно версия пакета B удовлетворяет всех потребителей. Затем NuGet делает то же самое для всех других пакетов, независимо от того, насколько глубоким становится граф зависимостей.

Дополнительные сведения о том, как NuGet выполняет эту задачу, см. в разделе [Разрешение зависимостей](Consume-Packages/Dependency-Resolution.md).

## <a name="tracking-references-and-restoring-packages"></a>Отслеживание ссылок и восстановление пакетов

Так как проекты можно легко перемещать между компьютерами разработчиков, репозиториями для управления исходным кодом, серверами сборки и т. д., крайне непрактично хранить двоичные сборки из пакетов NuGet напрямую привязанными к проекту. Это не только раздует каждую копию проекта (что приведет к нецелесообразному расходу места в репозиториях для управления исходным кодом), но и сильно затруднит обновление двоичных файлов пакета до более новых версий, как это потребуется сделать по всем копиям проекта. 

Вместо этого NuGet просто ведет список пакетов, от которых зависит проект (включая зависимости верхнего и нижнего уровней), и дает возможность восстановить все указанные в ссылках пакеты по запросу, как описано в разделе [Восстановление пакетов](Consume-Packages/Package-Restore.md). То есть при установке пакета с некоторого узла в проект NuGet записывает идентификатор пакета и номер версии в этот список ссылок. (При удалении пакет, конечно же, убирается из этого списка.) 

![Список ссылок NuGet создается при установке пакета и может использоваться для восстановления пакетов в другом месте.](media/nuget-restore.png)

С помощью одного только списка ссылок NuGet может переустановить &mdash;то есть восстановить&mdash; все эти пакеты с открытых и (или) закрытых узлов в любой момент времени. (По этой причине nuget.org запрещает полностью удалять опубликованные пакеты, хотя их можно скрыть; см. раздел [Удаление пакетов](Policies/deleting-packages.md).) При фиксации проекта в системе управления исходным кодом или предоставления его для общего доступа каким-либо иным образом вам нужно включить только список ссылок и не нужно включать какие-либо двоичные файлы пакета (см. раздел [Пакеты и система управления исходным кодом](Consume-Packages/Packages-and-Source-Control.md).)

Компьютер, принимающий проект, например сервер сборки, получающий копию проекта в рамках работы системы автоматического развертывания, просто запрашивает у NuGet восстановление зависимости всякий раз, когда они понадобятся. Системы сборки, такие как Visual Studio Team Services, предоставляют шаги "Восстановление NuGet" именно для этой цели. Аналогично, когда разработчики получают копию проекта (как при клонировании репозитория), а затем открывают проект в Visual Studio и запускают сборку, Visual Studio автоматически восстанавливает нужные пакеты NuGet. Разработчики также могут в любое время велеть NuGet восстановить пакеты, используя команду CLI `nuget restore` или командлет `Install-Package` в консоли диспетчера пакетов.

Очевидно, что основная роль NuGet, связанная с разработчиками, заключается в обслуживании этого списка ссылок от имени проекта и предоставлении средств для эффективного восстановления (и обновления) таких указанных в ссылках пакетов.

Непосредственная реализация этого процесса видоизменялась в разных версиях NuGet, что привело к появлению нескольких различных *форматов управления пакетами*:

- [`packages.config`](Schema/packages-config.md): *(NuGet 1.0+)* XML-файл, содержащий плоский список всех зависимостей в проекте, включая зависимости других установленных пакетов. 
- [`project.json`](Schema/project-json.md): *(NuGet 3.0+)* JSON-файл, содержащий список зависимостей проекта, при этом общий граф по пакету приведен в связанном файле `project.lock.json`. Такая структура обеспечивает повышенную производительность по сравнению с `packages.config`, как описано в статье [Разрешение зависимостей](Consume-Packages/Dependency-Resolution.md), включая транзитивное восстановление, но обычно она заменяется описанной ниже структурой PackageReference.
- [Ссылки на пакет в файлах проекта](Consume-Packages/Package-References-in-Project-Files.md) (также известные как "PackageReference") | *(NuGet 4.0+)* Ведет список зависимостей верхнего уровня проекта непосредственно в файле проекта, поэтому отдельный файл не требуется. Связанный файл `project.assets.json` создается динамически, как и `project.lock.json`, для управления общим графом зависимостей.

Применение конкретного формата управления пакетами зависит от типа проекта и доступной версии Visual Studio и NuGet. Чтобы проверить, какой формат используется, просто найдите `packages.config` или `project.json` в корневом каталоге проекта после установки первого пакета. Если эти файлы отсутствуют, найдите в файле проекта элемент &lt;PackageReference&gt;.

Например, в Visual Studio 2017 `packages.config` используется большинством типов проектов, кроме проектов UWP C# и .NET Core, которые используют PackageReference. 

## <a name="what-else-does-nuget-do"></a>Что еще делает NuGet?

Подведем небольшой итог. NuGet предоставляет (в рамках своей роли размещения) центральный репозиторий nuget.org и поддерживает закрытое размещение. NuGet предоставляет разработчикам средства для создания, публикации и использования пакетов. И самое главное, NuGet ведет список ссылок для пакетов, используемых в проекте, а также позволяет восстанавливать и обновлять пакеты из этого списка.

Чтобы обеспечить эффективную работу этих процессов, NuGet осуществляет некоторые оптимизации в фоновом режиме. Прежде всего, NuGet управляет кэшами пакетов как на уровне компьютера, так и для отдельных пакетов, чтобы упростить установку и переустановку. Что касается кэша уровня компьютера, любой пакет, который вы скачиваете и устанавливаете в проекте, сохраняется в кэше, чтобы при установке того же пакета в другом проекте не пришлось скачивать его повторно. Это очень удобно, когда вы часто восстанавливаете большее количество пакетов, например, как на сервере сборки. Дополнительные сведения об этом механизме и работе с ним см. в разделе [Управление кэшем NuGet](Consume-Packages/Managing-the-Nuget-Cache.md).

В рамках отдельного проекта NuGet выполняет множество операций для управления общим графом зависимостей. (При использовании `project.json` или &lt;PackageReference&gt; NuGet хранит эти сведения во вторичном файле с именем `project.lock.json` и `project.assets.json`, соответственно.) Это также включает в себя разрешение нескольких ссылок на разные версии одного пакета.

Таким образом, довольно часто проект зависит от одного или нескольких пакетов, имеющих такие же зависимости. Например, некоторые из наиболее полезных пакетов служебных программ на сайте nuget.org используются многими другими пакетами. В общем графе зависимостей вы легко можете иметь десять различных ссылок на разные версии одного пакета. Однако вы не хотите привносить несколько версий этого пакета в само приложение, поэтому NuGet определяет, какую отдельную версию можно использовать. (Дополнительные сведения по этой теме см. в разделе [Разрешение зависимостей](Consume-Packages/Dependency-Resolution.md).)

Кроме того, NuGet обслуживает все спецификации, связанные со структурированием пакетов (включая [локализацию](Create-Packages/Creating-Localized-Packages.md) и [отладочные символы](Create-Packages/Symbol-Packages.md)) и ссылками на них (включая [ диапазоны версий](reference/package-versioning.md#version-ranges-and-wildcards) и [предварительные версии](create-packages/Prerelease-Packages.md).) NuGet также предоставляет API для поставщиков учетных данных (для доступа к закрытым узлам) и разработчиков, создающих шаблоны проектов и расширения Visual Studio.

Если изучить содержание этой документации, можно найти все указанные возможности и заметки о выпуске, отсылающие к самому начальному этапу развития NuGet.

## <a name="comments-contributions-and-issues"></a>Комментарии, вклады и проблемы

Мы убедительно просим вас оставлять комментарии и вносить вклад в эту документацию &mdash;просто выберите команды **Комментарии** и **Изменить** на любой странице или посетите [репозиторий документации](https://github.com/NuGet/docs.microsoft.com-nuget/) и [список проблем с документацией](https://github.com/NuGet/docs.microsoft.com-nuget/issues) на сайте GitHub.

Мы также рады вкладам в сам NuGet через [различные репозитории GitHub](https://github.com/NuGet/Home); сведения о проблемах NuGet приведены по адресу [https://github.com/NuGet/home/issues](https://github.com/NuGet/home/issues).

Надеемся, что вам понравится работать с NuGet.

---
title: Восстановление пакета NuGet
description: Описание того, как NuGet восстанавливает пакеты, от которых зависит проект, включая отключение восстановления и ограничения версий.
author: karann-msft
ms.author: karann
ms.date: 03/16/2018
ms.topic: conceptual
ms.openlocfilehash: da69181aebe3bebcea6acd6e15fde6b77dd33452
ms.sourcegitcommit: ffbdf147f84f8bd60495d3288dff9a5275491c17
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/13/2018
ms.locfileid: "51580302"
---
# <a name="package-restore"></a><span data-ttu-id="5f23e-103">Восстановление пакетов</span><span class="sxs-lookup"><span data-stu-id="5f23e-103">Package Restore</span></span>

<span data-ttu-id="5f23e-104">Чтобы очистить среду разработки и уменьшить размер репозитория, **функция восстановления пакетов** NuGet устанавливает все зависимости проекта, указанные в файле проекта или файле `packages.config`.</span><span class="sxs-lookup"><span data-stu-id="5f23e-104">To promote a cleaner development environment and to reduce repository size, NuGet **Package Restore** installs all a project's dependencies as listed in either the project file or `packages.config`.</span></span> <span data-ttu-id="5f23e-105">Visual Studio может автоматически восстановить пакеты при построении проекта.</span><span class="sxs-lookup"><span data-stu-id="5f23e-105">Visual Studio can restore packages automatically when a project is built.</span></span> <span data-ttu-id="5f23e-106">Это можно сделать также с помощью команд `dotnet build` и `dotnet run` (.NET Core 2.0 и более поздних версий).</span><span class="sxs-lookup"><span data-stu-id="5f23e-106">The `dotnet build` and `dotnet run` commands (.NET Core 2.0+) also perform an automatic restore.</span></span> <span data-ttu-id="5f23e-107">Кроме того, пакеты можно восстановить в любое время с помощью Visual Studio, `nuget restore`, `dotnet restore` и xbuild в Mono.</span><span class="sxs-lookup"><span data-stu-id="5f23e-107">You can also restore packages at any time through Visual Studio, `nuget restore`, `dotnet restore`, and xbuild on Mono.</span></span>

<span data-ttu-id="5f23e-108">Восстановление пакетов гарантирует доступность всех зависимостей проекта без сохранения этих пакетов в системе управления версиями.</span><span class="sxs-lookup"><span data-stu-id="5f23e-108">Package restore makes sure that all a project's dependencies are available without storing those packages in source control.</span></span> <span data-ttu-id="5f23e-109">Дополнительные сведения о настройке исключения двоичных файлов пакетов в репозитории см. в статье [Пропуск пакетов NuGet в системах управления исходным кодом](../consume-packages/packages-and-source-control.md).</span><span class="sxs-lookup"><span data-stu-id="5f23e-109">See [Packages and Source Control](../consume-packages/packages-and-source-control.md) on how to configure your repository to exclude package binaries.</span></span>

## <a name="package-restore-overview"></a><span data-ttu-id="5f23e-110">Обзор восстановления пакетов</span><span class="sxs-lookup"><span data-stu-id="5f23e-110">Package restore overview</span></span>

<span data-ttu-id="5f23e-111">При восстановлении пакетов сначала устанавливаются необходимые прямые зависимости проекта, а затем остальные зависимости этих пакетов во всей схеме зависимостей.</span><span class="sxs-lookup"><span data-stu-id="5f23e-111">Restoring packages first installs the direct dependencies of a project as needed, then installs any dependencies of those packages throughout the entire dependency graph.</span></span>

<span data-ttu-id="5f23e-112">Если пакет не установлен, NuGet сначала попытается извлечь его из [кэша](../consume-packages/managing-the-global-packages-and-cache-folders.md).</span><span class="sxs-lookup"><span data-stu-id="5f23e-112">If a package is not already installed, NuGet first attempts to retrieve it from the [cache](../consume-packages/managing-the-global-packages-and-cache-folders.md).</span></span> <span data-ttu-id="5f23e-113">Если пакета нет в кэше, NuGet пытается скачать его из всех включенных источников (см. статью [Настройка поведения NuGet](Configuring-NuGet-Behavior.md)), которые также отображаются в списке **Сервис > Параметры > Диспетчер пакетов NuGet > Источники пакетов** в Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="5f23e-113">If the package is not in the cache, NuGet then attempts to download the package from all enabled sources (see [Configuring NuGet behavior](Configuring-NuGet-Behavior.md); sources also appear in the  **Tools > Options > NuGet Package Manager > Package Sources** list in Visual Studio).</span></span> <span data-ttu-id="5f23e-114">Во время восстановления NuGet игнорирует порядок источников пакетов, используя пакет из любого источника, первым ответившего на запросы.</span><span class="sxs-lookup"><span data-stu-id="5f23e-114">During restore, NuGet ignores the order of package sources, using the package from whichever source is first to respond to requests.</span></span>

> [!Note]
> <span data-ttu-id="5f23e-115">NuGet не сообщает о сбое восстановления пакета до проверки всех источников.</span><span class="sxs-lookup"><span data-stu-id="5f23e-115">NuGet does not indicate a failure to restore a package until all the sources have been checked.</span></span> <span data-ttu-id="5f23e-116">После проверки NuGet сообщает о сбое только для последнего источника в списке.</span><span class="sxs-lookup"><span data-stu-id="5f23e-116">At that time, NuGet reports a failure for only the last source in the list.</span></span> <span data-ttu-id="5f23e-117">Такая ошибка означает, что пакет отсутствовал и во *всех* других источниках, хотя отдельные ошибки для них не выдавались.</span><span class="sxs-lookup"><span data-stu-id="5f23e-117">The error implies that the package wasn't present on *any* of the other sources, even though errors are not shown for each of those sources individually.</span></span>

<span data-ttu-id="5f23e-118">Восстановление пакета инициируется с помощью следующих методов:</span><span class="sxs-lookup"><span data-stu-id="5f23e-118">Package restore is triggered in the following ways:</span></span>

- <span data-ttu-id="5f23e-119">**Интерфейс командной строки dotnet**: выполните команду [dotnet restore](/dotnet/core/tools/dotnet-restore?tabs=netcore2x) для восстановления пакетов в файле проекта (дополнительные сведения см. в статье [Ссылки на пакеты (PackageReference) в файлах проектов](../consume-packages/package-references-in-project-files.md)).</span><span class="sxs-lookup"><span data-stu-id="5f23e-119">**dotnet CLI**: use the [dotnet restore](/dotnet/core/tools/dotnet-restore?tabs=netcore2x) command, which restores packages listed in the project file (see [PackageReference](../consume-packages/package-references-in-project-files.md)).</span></span> <span data-ttu-id="5f23e-120">При использовании .NET Core версии 2.0 и более поздней автоматическое восстановление доступно с помощью команд `dotnet build` и `dotnet run`.</span><span class="sxs-lookup"><span data-stu-id="5f23e-120">With .NET Core 2.0 and later, restore is done automatically with `dotnet build` and `dotnet run`.</span></span>

- <span data-ttu-id="5f23e-121">**Пользовательский интерфейс диспетчера пакетов (Visual Studio в Windows)**: пакеты автоматически восстанавливаются при создании проекта из шаблона и формировании проекта (как описано в разделе [Включение и отключение восстановления пакетов](#enabling-and-disabling-package-restore)).</span><span class="sxs-lookup"><span data-stu-id="5f23e-121">**Package Manager UI (Visual Studio on Windows)**: Packages are restored automatically when creating a project from a template and when building a project (subject to the option described in [Enabling and disabling package restore](#enabling-and-disabling-package-restore)).</span></span> <span data-ttu-id="5f23e-122">В NuGet 4.0 и более поздних версий также доступно автоматическое восстановление при изменении проекта на основе пакета SDK для .NET Core.</span><span class="sxs-lookup"><span data-stu-id="5f23e-122">In NuGet 4.0+, restore also happens automatically when changes are made to a .NET Core SDK-based project.</span></span>

    <span data-ttu-id="5f23e-123">Чтобы восстановить пакет вручную, щелкните правой кнопкой мыши решение в обозревателе решений и выберите **Восстановить пакеты NuGet**.</span><span class="sxs-lookup"><span data-stu-id="5f23e-123">To restore manually, right-click the solution in Solution Explorer and select **Restore NuGet Packages**.</span></span> <span data-ttu-id="5f23e-124">Если один или несколько отдельных пакетов по-прежнему не установлены надлежащим образом (то есть для них в обозревателе решений отображается значок ошибки), удалите затрагиваемые пакеты с помощью пользовательского интерфейса диспетчера пакетов, после чего повторно установите их.</span><span class="sxs-lookup"><span data-stu-id="5f23e-124">If one or more individual packages are still not installed properly (meaning that Solution Explorer shows an error icon), then use the Package Manager UI to uninstall and reinstall the affected packages.</span></span> <span data-ttu-id="5f23e-125">См. раздел [Повторная установка и обновление пакетов](../consume-packages/reinstalling-and-updating-packages.md)</span><span class="sxs-lookup"><span data-stu-id="5f23e-125">See [Reinstalling and updating packages](../consume-packages/reinstalling-and-updating-packages.md)</span></span>

    <span data-ttu-id="5f23e-126">Если отображается ошибка "Данный проект ссылается на пакеты NuGet, отсутствующие на этом компьютере" или "Необходимо восстановить один или несколько пакетов NuGet, однако это невозможно без вашего согласия", включите автоматическое восстановление, следуя инструкциям в разделе [Включение и отключение восстановления пакетов](#enabling-and-disabling-package-restore).</span><span class="sxs-lookup"><span data-stu-id="5f23e-126">If you see the error "This project references NuGet package(s) that are missing on this computer" or "One or more NuGet packages need to be restored but couldn't be because consent has not been granted," turn on automatic restore by following the instructions under [Enabling and disabling package restore](#enabling-and-disabling-package-restore).</span></span> <span data-ttu-id="5f23e-127">Дополнительные сведения см. в статье [Устранение ошибок при восстановлении пакетов](Package-restore-troubleshooting.md).</span><span class="sxs-lookup"><span data-stu-id="5f23e-127">Also see [Package restore troubleshooting](Package-restore-troubleshooting.md).</span></span>

- <span data-ttu-id="5f23e-128">**NuGet CLI.** Выполните команду [nuget restore](../tools/cli-ref-restore.md), которая позволяет восстановить пакеты, указанные в файле проекта или файле `packages.config`.</span><span class="sxs-lookup"><span data-stu-id="5f23e-128">**NuGet CLI**: use the [nuget restore](../tools/cli-ref-restore.md) command, which restores packages listed in the project file or in `packages.config`.</span></span> <span data-ttu-id="5f23e-129">Вы можете также указать файл решения.</span><span class="sxs-lookup"><span data-stu-id="5f23e-129">You can also specify a solution file.</span></span>

- <span data-ttu-id="5f23e-130">**MSBuild.** Выполните команду [msbuild /t:restore](../reference/msbuild-targets.md#restore-target), которая позволяет восстановить пакеты в файле проекта (только формат PackageReference).</span><span class="sxs-lookup"><span data-stu-id="5f23e-130">**MSBuild**: use the [msbuild /t:restore](../reference/msbuild-targets.md#restore-target) command, which restores packages packages listed in the project file (PackageReference only).</span></span> <span data-ttu-id="5f23e-131">Доступно только в NuGet версии 4.x и более поздних и MSBuild версии 15.1 и более поздних, включенных в Visual Studio 2017.</span><span class="sxs-lookup"><span data-stu-id="5f23e-131">Available only in NuGet 4.x+ and MSBuild 15.1+, which are included with Visual Studio 2017.</span></span> <span data-ttu-id="5f23e-132">`nuget restore` и `dotnet restore` используют эту команду для подходящих проектов.</span><span class="sxs-lookup"><span data-stu-id="5f23e-132">`nuget restore` and `dotnet restore` both use this command for applicable projects.</span></span>

- <span data-ttu-id="5f23e-133">**Visual Studio Team Services**: при создании определения сборки в Team Services включите в него задачу [восстановления NuGet](/vsts/build-release/tasks/package/nuget#restore-nuget-packages) или [.NET Core](/vsts/build-release/tasks/build/dotnet-core#restore-nuget-packages), а затем добавьте задачу сборки.</span><span class="sxs-lookup"><span data-stu-id="5f23e-133">**Visual Studio Team Services**: When creating a build definition on Team Services, include the [NuGet restore](/vsts/build-release/tasks/package/nuget#restore-nuget-packages) or [.NET Core Restore](/vsts/build-release/tasks/build/dotnet-core#restore-nuget-packages) task in the definition before any build task.</span></span> <span data-ttu-id="5f23e-134">Эта задача по умолчанию входит в несколько шаблонов сборки.</span><span class="sxs-lookup"><span data-stu-id="5f23e-134">This task is included by default in a number of build templates.</span></span>

- <span data-ttu-id="5f23e-135">**Team Foundation Server**: в TFS 2013 и более поздних версий пакеты восстанавливаются автоматически во время сборки при условии, что вы используете шаблон командной сборки для TFS 2013 или более поздней версии.</span><span class="sxs-lookup"><span data-stu-id="5f23e-135">**Team Foundation Server**: TFS 2013 and later automatically restores packages during build, provided that you're using a Team Build Template for TFS 2013 or later.</span></span> <span data-ttu-id="5f23e-136">Для более ранней версии TFS можно просто включить шаг сборки, чтобы вызвать один из параметров восстановления из командной строки, как описано выше.</span><span class="sxs-lookup"><span data-stu-id="5f23e-136">For earlier version of TFS, you can include a build step to invoke one of the command-line restore options above.</span></span> <span data-ttu-id="5f23e-137">При необходимости можно перенести шаблон сборки в TFS 2013.</span><span class="sxs-lookup"><span data-stu-id="5f23e-137">You can optionally migrate the build template to TFS 2013.</span></span> <span data-ttu-id="5f23e-138">Дополнительные сведения см. в статье [Настройка восстановления пакетов с помощью сборки Team Foundation](../consume-packages/team-foundation-build.md).</span><span class="sxs-lookup"><span data-stu-id="5f23e-138">For more information, see the [Walkthrough of package restore with Team Foundation Build](../consume-packages/team-foundation-build.md).</span></span>

## <a name="enabling-and-disabling-package-restore"></a><span data-ttu-id="5f23e-139">Включение и отключение восстановления пакетов</span><span class="sxs-lookup"><span data-stu-id="5f23e-139">Enabling and disabling package restore</span></span>

<span data-ttu-id="5f23e-140">Восстановление пакетов можно включить в меню **Сервис > Параметры > Диспетчер пакетов NuGet** в Visual Studio:</span><span class="sxs-lookup"><span data-stu-id="5f23e-140">Package restore is primarily enabled through **Tools > Options > NuGet Package Manager** in Visual Studio:</span></span>

![Управление поведением восстановления пакетов с помощью параметров диспетчера пакетов NuGet](media/Restore-01-AutoRestoreOptions.png)

- <span data-ttu-id="5f23e-142">**Разрешить NuGet скачивать отсутствующие пакеты**: определяет все формы восстановления пакетов, изменяя `packageRestore/enabled` в файле `NuGet.Config`, как показано ниже (`%AppData%\NuGet\NuGet.Config` в Windows, `~/.nuget/NuGet/NuGet.Config` в Mac/Linux).</span><span class="sxs-lookup"><span data-stu-id="5f23e-142">**Allow NuGet to download missing packages**: controls all forms of package restore by changing the `packageRestore/enabled` setting in the `NuGet.Config` file as shown below (`%AppData%\NuGet\NuGet.Config` on Windows, `~/.nuget/NuGet/NuGet.Config` on Mac/Linux).</span></span> <span data-ttu-id="5f23e-143">В Visual Studio этот параметр обеспечивает работу команды **Восстановить пакеты NuGet** в контекстном меню решения.</span><span class="sxs-lookup"><span data-stu-id="5f23e-143">In Visual Studio, this setting allows the **Restore NuGet Packages** command on the solution's context menu to work.</span></span>

    ```xml
    <configuration>
        <packageRestore>
            <!-- The 'enabled' key is True when the "Allow NuGet to download missing packages" checkbox is set.
                 Clearing the box sets this to False, disabling command-line, automatic, and MSBuild-Integrated restore. -->
            <add key="enabled" value="True" />
        </packageRestore>
    </configuration>
    ```

> [!Note]
>  <span data-ttu-id="5f23e-144">Параметр `packageRestore/enabled` можно переопределить на глобальном уровне, задав для переменной среды с именем **EnableNuGetPackageRestore** значение TRUE или FALSE перед запуском Visual Studio или началом сборки.</span><span class="sxs-lookup"><span data-stu-id="5f23e-144">The `packageRestore/enabled` setting can be overridden globally by setting an environment variable called **EnableNuGetPackageRestore** with a value of TRUE or FALSE before launching Visual Studio or starting a build.</span></span>

- <span data-ttu-id="5f23e-145">**Автоматически проверять отсутствие пакетов при сборке в Visual Studio**: управляет автоматическим восстановлением, изменяя параметр `packageRestore/automatic` в файле `NuGet.Config`, как показано ниже (`%AppData%\NuGet\NuGet.Config` в Windows, `~/.nuget/NuGet/NuGet.Config` в Mac/Linux).</span><span class="sxs-lookup"><span data-stu-id="5f23e-145">**Automatically check for missing packages during build in Visual Studio**: controls automatic restore by changing the `packageRestore/automatic` setting in the `NuGet.Config` file as shown below (`%AppData%\NuGet\NuGet.Config` on Windows, `~/.nuget/NuGet/NuGet.Config` on Mac/Linux).</span></span> <span data-ttu-id="5f23e-146">Когда этот параметр задан, при запуске сборки из Visual Studio все отсутствующие пакеты восстанавливаются автоматически.</span><span class="sxs-lookup"><span data-stu-id="5f23e-146">When this option is set, running a build from Visual Studio automatically restores any missing packages.</span></span> <span data-ttu-id="5f23e-147">Этот параметр не затрагивает сборки, запускаемые из командной строки с помощью MSBuild.</span><span class="sxs-lookup"><span data-stu-id="5f23e-147">The option does not affect builds run from the command line using MSBuild.</span></span>

    ```xml
    ...
    <configuration>
        <packageRestore>
            <!-- The 'automatic' key is set to True when the "Automatically check for missing packages during
                 build in Visual Studio" checkbox is set. Clearing the box sets this to False and disables
                 automatic restore. -->
            <add key="automatic" value="True" />
        </packageRestore>
    </configuration>
    ```

<span data-ttu-id="5f23e-148">Справочную информацию см. в разделе [Файл конфигурации NuGet — packageRestore](../reference/nuget-config-file.md#packagerestore-section).</span><span class="sxs-lookup"><span data-stu-id="5f23e-148">For reference, see the [NuGet config file - packageRestore section](../reference/nuget-config-file.md#packagerestore-section).</span></span>

<span data-ttu-id="5f23e-149">В некоторых случаях разработчику или организации может потребоваться включить или отключить восстановление пакетов на компьютере для всех пользователей.</span><span class="sxs-lookup"><span data-stu-id="5f23e-149">In some cases, a developer or company might want to enable or disable package restore for all users on a computer.</span></span> <span data-ttu-id="5f23e-150">Это можно сделать, добавив указанные выше параметры в файл глобальной конфигурации NuGet, находящийся в папке `%ProgramData%\NuGet\Config` (папка `\{IDE}\{Version}\{SKU}\` для Visual Studio в ОС Windows) или `~/.local/share` (Mac или Linux).</span><span class="sxs-lookup"><span data-stu-id="5f23e-150">To do this, add the same settings above to the global NuGet configuration file located in `%ProgramData%\NuGet\Config` (Windows, potentially under a specific `\{IDE}\{Version}\{SKU}\` folder for Visual Studio) or `~/.local/share` (Mac/Linux).</span></span> <span data-ttu-id="5f23e-151">После этого отдельные пользователи могут выборочно включить восстановление на уровне проекта по необходимости.</span><span class="sxs-lookup"><span data-stu-id="5f23e-151">Individual users can then selectively enable restore as needed on a project level.</span></span> <span data-ttu-id="5f23e-152">Точные сведения о том, как NuGet устанавливает приоритеты для нескольких файлов конфигурации, см. в разделе [Порядок применения параметров](../consume-packages/configuring-nuget-behavior.md#how-settings-are-applied).</span><span class="sxs-lookup"><span data-stu-id="5f23e-152">See [Configuring NuGet behavior](../consume-packages/configuring-nuget-behavior.md#how-settings-are-applied) for exact details on how NuGet prioritizes multiple config files.</span></span>

> [!Important]
> <span data-ttu-id="5f23e-153">При изменении параметров `packageRestore` прямо в `nuget.config` нужно перезапустить Visual Studio, чтобы диалоговое окно параметров отображало текущие значения.</span><span class="sxs-lookup"><span data-stu-id="5f23e-153">If you edit the `packageRestore` settings directly in `nuget.config`, restart Visual Studio so that the options dialog box shows the current values.</span></span>

## <a name="constraining-package-versions-with-restore"></a><span data-ttu-id="5f23e-154">Ограничение версий пакетов при восстановлении</span><span class="sxs-lookup"><span data-stu-id="5f23e-154">Constraining package versions with restore</span></span>

<span data-ttu-id="5f23e-155">При восстановлении пакетов любым из методов NuGet учитывает все ограничения, указанные в `packages.config` или файле проекта:</span><span class="sxs-lookup"><span data-stu-id="5f23e-155">When restoring packages through any method, NuGet honors any constraints specified in `packages.config` or the project file:</span></span>

- <span data-ttu-id="5f23e-156">`packages.config`: укажите диапазон версий в свойстве `allowedVersion` зависимости.</span><span class="sxs-lookup"><span data-stu-id="5f23e-156">`packages.config`: Specify a version range in the `allowedVersion` property of the dependency.</span></span> <span data-ttu-id="5f23e-157">Дополнительные сведения см. в разделе [Ограничение версий для обновления](../consume-packages/reinstalling-and-updating-packages.md#constraining-upgrade-versions).</span><span class="sxs-lookup"><span data-stu-id="5f23e-157">See [Reinstalling and updating packages](../consume-packages/reinstalling-and-updating-packages.md#constraining-upgrade-versions).</span></span> <span data-ttu-id="5f23e-158">Пример:</span><span class="sxs-lookup"><span data-stu-id="5f23e-158">For example:</span></span>

    ```xml
    <package id="Newtonsoft.json" version="6.0.4" allowedVersions="[6,7)" />
    ```

- <span data-ttu-id="5f23e-159">Файл проекта (PackageReference): укажите диапазон версий непосредственно с номером версии зависимости.</span><span class="sxs-lookup"><span data-stu-id="5f23e-159">Project file (PackageReference): Specify a version range directly with the dependency's version number.</span></span> <span data-ttu-id="5f23e-160">Пример:</span><span class="sxs-lookup"><span data-stu-id="5f23e-160">For example:</span></span>

    ```xml
    <PackageReference Include="Newtonsoft.json" Version="[6, 7)" />
    ```

<span data-ttu-id="5f23e-161">Во всех случаях используйте нотацию, описанную в статье [Управление версиями пакета](../reference/package-versioning.md).</span><span class="sxs-lookup"><span data-stu-id="5f23e-161">In all cases, use the notation described in [Package versioning](../reference/package-versioning.md).</span></span>

## <a name="forcing-restore-from-package-sources"></a><span data-ttu-id="5f23e-162">Принудительное восстановление из источников пакетов</span><span class="sxs-lookup"><span data-stu-id="5f23e-162">Forcing restore from package sources</span></span>

<span data-ttu-id="5f23e-163">По умолчанию в операциях восстановления NuGet используются пакеты из папки *global-packages* и *http-cache*, как описано в статье [Управление папкой установки глобальных пакетов, кэшем и временными папками](managing-the-global-packages-and-cache-folders.md).</span><span class="sxs-lookup"><span data-stu-id="5f23e-163">By default, NuGet restore operations use packages from the *global-packages* and *http-cache* folders, which are described on [Managing the global packages and cache folders](managing-the-global-packages-and-cache-folders.md).</span></span>

<span data-ttu-id="5f23e-164">Чтобы папка *global-packages* не использовалась, сделайте следующее:</span><span class="sxs-lookup"><span data-stu-id="5f23e-164">To avoid using the *global-packages* folder, do one of the following:</span></span>

- <span data-ttu-id="5f23e-165">Очистите папку с помощью команды `nuget locals global-packages -clear` или `dotnet nuget locals global-packages --clear`.</span><span class="sxs-lookup"><span data-stu-id="5f23e-165">Clear the folder using `nuget locals global-packages -clear` or `dotnet nuget locals global-packages --clear`</span></span>
- <span data-ttu-id="5f23e-166">Перед операцией восстановления временно измените расположение папки *global-packages* с помощью одного из следующих методов:</span><span class="sxs-lookup"><span data-stu-id="5f23e-166">Temporarily change the location of the *global-packages* folder before the restore operation using one of the following methods:</span></span>
  - <span data-ttu-id="5f23e-167">В качестве значения переменной среды NUGET_PACKAGES задайте другую папку.</span><span class="sxs-lookup"><span data-stu-id="5f23e-167">Set the NUGET_PACKAGES environment variable to a different folder.</span></span>
  - <span data-ttu-id="5f23e-168">Создайте файл `NuGet.Config`, который в качестве значения параметра `globalPackagesFolder` (при использовании формата PackageReference) или `repositoryPath` (при использовании `packages.config`) задает другую папку (см. раздел о [параметрах конфигурации](../reference/nuget-config-file.md#config-section)).</span><span class="sxs-lookup"><span data-stu-id="5f23e-168">Create a `NuGet.Config` file that sets `globalPackagesFolder` (if using PackageReference) or `repositoryPath` (if using `packages.config`) to a different folder (see [configuration settings](../reference/nuget-config-file.md#config-section)</span></span>
  - <span data-ttu-id="5f23e-169">Только MSBuild. Укажите другую папку с помощью свойства `RestorePackagesPath`.</span><span class="sxs-lookup"><span data-stu-id="5f23e-169">MSBuild only: specify a different folder with the `RestorePackagesPath` property.</span></span>

<span data-ttu-id="5f23e-170">Чтобы не использовать кэш с источниками HTTP, выполните одно из следующих действий:</span><span class="sxs-lookup"><span data-stu-id="5f23e-170">To avoid using the cache for HTTP sources, do one of the following:</span></span>

- <span data-ttu-id="5f23e-171">Используйте параметр `-NoCache` с `nuget restore` или параметр `--no-cache` с `dotnet restore`.</span><span class="sxs-lookup"><span data-stu-id="5f23e-171">Use the `-NoCache` option with `nuget restore` or the `--no-cache` option with `dotnet restore`.</span></span> <span data-ttu-id="5f23e-172">Эти параметры не влияют на операции восстановления с помощью пользовательского интерфейса диспетчера пакетов или консоли Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="5f23e-172">These options do not affect restore operations through the Visual Studio Package Manager UI or Console.</span></span>
- <span data-ttu-id="5f23e-173">Очистите кэш с помощью команды `nuget locals http-cache -clear` или `dotnet nuget locals http-cache --clear`.</span><span class="sxs-lookup"><span data-stu-id="5f23e-173">Clear the cache using `nuget locals http-cache -clear` or `dotnet nuget locals http-cache --clear`.</span></span>
- <span data-ttu-id="5f23e-174">Временно в качестве значения переменной среды NUGET_HTTP_CACHE_PATH задайте другую папку.</span><span class="sxs-lookup"><span data-stu-id="5f23e-174">Temporarily set of the NUGET_HTTP_CACHE_PATH environment variable to a different folder.</span></span>

## <a name="troubleshooting"></a><span data-ttu-id="5f23e-175">Устранение неполадок</span><span class="sxs-lookup"><span data-stu-id="5f23e-175">Troubleshooting</span></span>

<span data-ttu-id="5f23e-176">Дополнительные сведения см. в статье [Устранение ошибок при восстановлении пакетов в Visual Studio](package-restore-troubleshooting.md).</span><span class="sxs-lookup"><span data-stu-id="5f23e-176">See [Troubleshooting package restore](package-restore-troubleshooting.md).</span></span>
